abline(v = median(a.b),col = "red", lwd = 2)
abline(v = median(a.b.prior),col="blue", lwd = 2)
lines(density(a.b.prior),col = 'blue', lwd = 2)
abline(v = y.x, col = "black", lwd = 2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "blue","black"), lty=1,cex=0.8,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(0,1))
abline(v = median(a.b),col = "red", lwd = 2)
abline(v = median(a.b.prior),col="blue", lwd = 2)
lines(density(a.b.prior),col = 'blue', lwd = 2)
abline(v = y.x, col = "black", lwd = 2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "blue","black"), lty=1,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(0,1))
abline(v = median(a.b),col = "red", lwd = 2)
abline(v = median(a.b.prior),col="blue", lwd = 2)
lines(density(a.b.prior),col = 'blue')
abline(v = y.x, col = "black", lwd = 2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "blue","black"), lty=1,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(0,1))
abline(v = median(a.b),col = "red", lwd = 2)
abline(v = median(a.b.prior),col="black", lwd = 2)
lines(density(a.b.prior),col = 'black')
abline(v = y.x, col = "blue", lwd = 2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "black","blue"), lty=1,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(0,1))
abline(v = median(a.b),col = "red", lwd = 2)
abline(v = median(a.b.prior),col="black", lwd = 2)
lines(density(a.b.prior),col = 'black')
abline(v = y.x, col = "blue", lwd = 2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "black","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(0,1))
abline(v = median(a.b),col = "red", lwd = 2)
# prior
abline(v = median(a.b.prior),col="black", lwd = 2)
lines(density(a.b.prior),col = 'black')
# observed
abline(v = y.x, col = "blue", lwd = 2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "black","blue"), lty=3,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(0,1))
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="black", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'black')
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "black","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(0,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="black", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'black',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "black","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(0,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-1,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.5,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,2))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("theta_i vs. yi/xi"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("theta_i (median)", "yi/xi"),
col=c("red", "blue"), lty=1,cex=0.6)
}
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- median(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- median(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = mean(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = mean(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,2))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("theta_i vs. yi/xi"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = mean(theta.post[,j]), col = "red")
legend('topright', legend=c("theta_i (median)", "yi/xi"),
col=c("red", "blue"), lty=1,cex=0.6)
}
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,2))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("theta_i vs. yi/xi"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("theta_i (median)", "yi/xi"),
col=c("red", "blue"), lty=1,cex=0.6)
}
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- median(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="green", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'green',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "green","blue"), lty=2,cex=1,lwd = 3)
par(mfrow=c(2,2))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2")
abline(a = 0, b = 1, col = "red")
}
par(mfrow=c(2,2))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2")
abline(a = 0, b = 1, col = "red", lwd=2)
}
sapply(setdiff(1:6, 2), function(j) {
mean(theta.post[, 2] > theta.post[,j])
})
mean(theta.post[, 2] == apply(theta.post, 1, max))
y/x
par(mfrow=c(2,2))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2")
abline(a = 0, b = 1, col = "red", lwd=2)
fit <- lm(theta.post[, 2] ~ theta.post[, j])
abline(fit, col = "blue", lwd = 2)
}
par(mfrow=c(2,2))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2")
abline(a = 0, b = 1, col = "red", lwd=2)
}
par(mfrow=c(3,3))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2")
abline(a = 0, b = 1, col = "red", lwd=2)
}
par(mfrow=c(3,3))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2")
abline(a = 0, b = 1, col = "red", lwd=2)
}
par(mfrow=c(3,2))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2")
abline(a = 0, b = 1, col = "red", lwd=2)
}
par(mfrow=c(2,3))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2")
abline(a = 0, b = 1, col = "red", lwd=2)
}
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(3,2))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("theta_i vs. yi/xi"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("theta_i (median)", "yi/xi"),
col=c("red", "blue"), lty=1,cex=0.6)
}
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,3))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("theta_i vs. yi/xi"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("theta_i (median)", "yi/xi"),
col=c("red", "blue"), lty=1,cex=0.6)
}
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="grey", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'grey',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "grey","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="grey", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'grey',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "grey","blue"), lty=2,cex=1,lwd = 3)
theme_bw()
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "posterior",main = "a/b vs. y/x.mean", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="grey", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'grey',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "grey","blue"), lty=2,cex=1,lwd = 3)
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "disease rate",main = "Posterior vs. Prior vs. Observed data", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="grey", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'grey',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "grey","blue"), lty=2,cex=1,lwd = 3)
par(mfrow=c(2,3))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2", main="2nd County vs. Other")
abline(a = 0, b = 1, col = "red", lwd=2)
}
par(mfrow=c(2,3))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2", main="County 2 vs. Other")
abline(a = 0, b = 1, col = "red", lwd=2)
}
par(mfrow=c(2,3))
for (j in setdiff(1:6, 2)) {
plot(theta.post[, j], theta.post[, 2], xlab = paste0("theta",j),
ylab = "theta2", main="Disease rate (2 vs. i)")
abline(a = 0, b = 1, col = "red", lwd=2)
}
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,3))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("Posterior i vs. Observed i"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("theta_i (median)", "yi/xi"),
col=c("red", "blue"), lty=1,cex=0.6)
}
a.b <- THETA[burn_in:S, 1]/THETA[burn_in:S,2]
a.b.prior <- rgamma(S-burn_in + 1, 1, 1)/rgamma(S-burn_in + 1,10, 1)
y.x <- mean(y/x)
# posterior
plot(density(a.b), xlab = "disease rate",main = "Posterior vs. Prior vs. Observed data (6 counties)", col='red',xlim=c(-0.2,1),lwd = 2)
abline(v = median(a.b),col = "red", lwd = 2,lty=2)
# prior
abline(v = median(a.b.prior),col="grey", lwd = 2, lty=2)
lines(density(a.b.prior),col = 'grey',lwd = 2)
# observed
abline(v = y.x, col = "blue", lwd = 2, lty=2)
legend('topright', legend=c("posterior.median", "prior.median","y/x.mean"),
col=c("red", "grey","blue"), lty=2,cex=1,lwd = 3)
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,3))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("Disease rate (Posterior vs. Obs"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("theta_i (median)", "yi/xi"),
col=c("red", "blue"), lty=1,cex=0.6)
}
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,3))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("Disease rate (Post vs. Obs"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("theta_i (median)", "yi/xi"),
col=c("red", "blue"), lty=1,cex=0.6)
}
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,3))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("Disease rate (Post vs. Obs)"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("theta_i (median)", "yi/xi"),
col=c("red", "blue"), lty=1,cex=0.6)
}
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,3))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("Disease rate (Post vs. Obs)"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("Posterior (median)", "Observed mean(yi/xi)"),
col=c("red", "blue"), lty=1,cex=0.6)
}
burn_in <- 1000
theta.post <- THETA[, -(1:2)]
y.x <- y/x
par(mfrow = c(2,3))
for (j in 1:6) {
plot(density(theta.post[,j]), xlab = paste0("theta", j),main = paste0("Disease rate (Post vs. Obs)"),
col='red')
abline(v = y.x[j],col = 'blue')
abline(v = median(theta.post[,j]), col = "red")
legend('topright', legend=c("Posterior (median)", "Observed mean(yi/xi)"),
col=c("red", "blue"), lty=1,cex=0.6)
}
